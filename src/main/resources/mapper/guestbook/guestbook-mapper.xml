<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ict.finalproject.guestbook.mapper.GuestbookMapper">

    <!-- ResultMap -->
    <resultMap id="guestbookMap" type="com.ict.finalproject.guestbook.vo.GuestbookVO">
        <id property="g_idx" column="g_idx"/>
        <result property="g_writer" column="g_writer"/>
        <result property="g_title" column="g_title"/>
        <result property="g_content" column="g_content"/>
        <result property="g_writedate" column="g_writedate"/>
        <result property="g_active" column="g_active"/>
    </resultMap>

    <!-- List -->
    <select id="getList" resultMap="guestbookMap">
        SELECT *
        FROM guestbook
        WHERE g_active = 1
        ORDER BY g_idx DESC
    </select>

    <!-- Paging -->
    <select id="getPageList" parameterType="map" resultMap="guestbookMap">
        SELECT *
        FROM guestbook
        WHERE g_active = 1
        ORDER BY g_idx DESC
        LIMIT #{start}, #{limit}
    </select>

    <!-- Total Count -->
    <select id="getTotalRecord" resultType="int">
        SELECT COUNT(*)
        FROM guestbook
        WHERE g_active = 1
    </select>

    <!-- Detail -->
    <select id="getDetail" parameterType="String" resultMap="guestbookMap">
        SELECT *
        FROM guestbook
        WHERE g_idx = #{g_idx}
    </select>

    <!-- Insert -->
    <insert id="getInsert" parameterType="com.ict.finalproject.guestbook.vo.GuestbookVO">
        INSERT INTO guestbook (
        g_writer,
        g_title,
        g_content,
        g_writedate,
        g_active
        ) VALUES (
        #{g_writer},
        #{g_title},
        #{g_content},
        #{g_writedate},
        1
        )
    </insert>

    <!-- Soft Delete -->
    <update id="getDelete" parameterType="String">
        UPDATE guestbook
        SET g_active = 0
        WHERE g_idx = #{g_idx}
    </update>

</mapper>
